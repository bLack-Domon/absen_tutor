<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  {% load static %}
  <link rel="icon" type="image/png" href="{% static 'img/icon.png' %}" />
  <link
    rel="shortcut icon"
    href="{% static 'img/icon.png' %}"
    type="image/x-icon"
  />
  <title>Daftar Absensi {{ tutor.get_full_name|default:tutor.username }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <div class="container-fluid mt-4">
    <h2>Daftar Absensi Tutor: {{ tutor.get_full_name|default:tutor.username }}</h2>
    <a href="{% url 'admin_dashboard' %}" class="btn btn-secondary mb-3">Kembali ke Dashboard</a>

    <div class="table-responsive">
      <table class="table table-striped table-hover align-middle">
        <thead class="text-center">
          <tr>
            <th>Tanggal</th>
            <th>Foto</th> <!-- Tambahan kolom foto -->
            <th>Status</th>
            <th>Keterangan</th>
          </tr>
        </thead>
        <tbody>
          {% for a in absensi %}
          <tr class="text-center">
            <td>{{ a.tanggal|date:"d F Y" }}</td>
            <td>
              {% if a.foto %}
                <img src="{{ a.foto.url }}" alt="Foto Absensi" style="max-height: 300px; max-width: 300px; object-fit: cover; border-radius: 4px;" />
              {% else %}
                <span class="text-muted">Tidak ada foto</span>
              {% endif %}
            </td>
            <td>
              <span class="badge 
                {% if a.status == 'menunggu' %} bg-warning 
                {% elif a.status == 'hadir' %} bg-success 
                {% elif a.status == 'izin' %} bg-primary 
                {% elif a.status == 'alpha' %} bg-danger 
                {% else %} bg-secondary 
                {% endif %}">
                {{ a.get_status_display }}
              </span>
            </td>
            <td>{{ a.keterangan }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="4" class="text-center text-muted">Belum ada absensi dalam 1 bulan terakhir.</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Pagination -->
    <nav aria-label="Navigasi halaman">
      <ul class="pagination justify-content-center">
        {% if absensi.has_previous %}
          <li class="page-item">
            <a class="page-link" href="?page={{ absensi.previous_page_number }}">«</a>
          </li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">«</span></li>
        {% endif %}

        {% for num in absensi.paginator.page_range %}
          {% if absensi.number == num %}
            <li class="page-item active"><span class="page-link">{{ num }}</span></li>
          {% elif num > absensi.number|add:-3 and num < absensi.number|add:3 %}
            <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
          {% endif %}
        {% endfor %}

        {% if absensi.has_next %}
          <li class="page-item">
            <a class="page-link" href="?page={{ absensi.next_page_number }}">»</a>
          </li>
        {% else %}
          <li class="page-item disabled"><span class="page-link">»</span></li>
        {% endif %}
      </ul>
    </nav>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
